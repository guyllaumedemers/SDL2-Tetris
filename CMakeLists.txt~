cmake_minimum_required(
    VERSION
    3.20.0
)

set(
	MYLANGUAGES
	CXX
)

project(
    SDL2-Tetris
    VERSION 0.0.0.0
    DESCRIPTION "Demo"
    LANGUAGES ${MYLANGUAGES}
)

# set project specifics

set(
	MYCXX_VERSION_STANDARD
	20
)

set_property(
	TARGET
	${PROJECT_NAME}
	PROPERTY
	CMAKE_CXX_STANDARD
	${MYCXX_VERSION_STANDARD}
)

if(NOT ${CMAKE_CXX_STANDARD} EQUAL ${MYCXX_VERSION_STANDARD})
	message(WARNING "WARNING! CXX_STANDARD SHOULD BE CXX_${MYCXX_VERSION_STANDARD}, CURRENTLY : ${CMAKE_CXX_STANDARD}")
endif()

set(
	CMAKE_CXX_STANDARD_REQUIRED
	ON
)

if(${CMAKE_CXX_STANDARD_REQUIRED})
	message(WARNING "WARNING! CXX_STANDARD_REQUIRED IS ${CMAKE_CXX_STANDARD_REQUIRED}. MAKE SURE YOU HAVE THE LATEST COMPILER VERSION SUPPORTING THE CURRENT REQUIREMENTS FOR CXX_${CMAKE_CXX_STANDARD}")
endif()

set(
	CMAKE_CXX_EXTENSIONS
	OFF
)

if(NOT ${CMAKE_CXX_EXTENSIONS})
	message(WARNING "WARNING! CXX_EXTENSIONS IS ${CMAKE_CXX_EXTENSIONS}!")
endif()

# check support for LINK Time Optimization between translation units

include(CheckIPOSupported)

check_ipo_supported(
	RESULT
	IS_IPO_SUPPORTED
	OUTPUT
	IPO_SUPPORT_RESULT
	LANGUAGES
	${MYLANGUAGES}
)

if(NOT ${IS_IPO_SUPPORTED})
	message(WARNING "IPO ADD ON SUPPORTED : ${IS_IPO_SUPPORTED}. ${IPO_SUPPORT_RESULT}")
else()
	set(
		CMAKE_INTERPROCEDURAL_OPTIMIZATION
		TRUE
	)
endif()

# check compiler features supported

set(
	PRINT_UNSUPPORTED_COMPILE_FEATURES
	FALSE
)

if(${PRINT_UNSUPPORTED_COMPILE_FEATURES})
	foreach(VAR IN LISTS CMAKE_CXX_COMPILE_FEATURES)
		list(FIND CMAKE_CXX_COMPILE_FEATURES ${VAR} RESULT COMPILE_FEATURE_SUPPORT_RESULT)
		if(NOT ${COMPILE_FEATURE_SUPPORT_RESULT})
			message(WARNING "WARNING! FEATURE NOT SUPPORTED : ${VAR}")
		endif()
	endforeach()
endif()

# add subdirectories

add_subdirectory(doc)
add_subdirectory(extern)
add_subdirectory(src bin)
add_subdirectory(test)
